!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,n){var o,r=e.getWrapperElement();return o=r.appendChild(document.createElement("div")),n?o.className="CodeMirror-dialog CodeMirror-dialog-bottom":o.className="CodeMirror-dialog CodeMirror-dialog-top","string"==typeof t?o.innerHTML=t:o.appendChild(t),o}function n(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}e.defineExtension("openDialog",function(o,r,i){function l(e){if("string"==typeof e)u.value=e;else{if(c)return;c=!0,s.parentNode.removeChild(s),f.focus(),i.onClose&&i.onClose(s)}}i||(i={}),n(this,null);var a,s=t(this,o,i.bottom),c=!1,f=this,u=s.getElementsByTagName("input")[0];return u?(i.value&&(u.value=i.value,i.selectValueOnOpen!==!1&&u.select()),i.onInput&&e.on(u,"input",function(e){i.onInput(e,u.value,l)}),i.onKeyUp&&e.on(u,"keyup",function(e){i.onKeyUp(e,u.value,l)}),e.on(u,"keydown",function(t){i&&i.onKeyDown&&i.onKeyDown(t,u.value,l)||((27==t.keyCode||i.closeOnEnter!==!1&&13==t.keyCode)&&(u.blur(),e.e_stop(t),l()),13==t.keyCode&&r(u.value,t))}),i.closeOnBlur!==!1&&e.on(u,"blur",l),u.focus()):(a=s.getElementsByTagName("button")[0])&&(e.on(a,"click",function(){l(),f.focus()}),i.closeOnBlur!==!1&&e.on(a,"blur",l),a.focus()),l}),e.defineExtension("openConfirm",function(o,r,i){function l(){c||(c=!0,a.parentNode.removeChild(a),f.focus())}n(this,null);var a=t(this,o,i&&i.bottom),s=a.getElementsByTagName("button"),c=!1,f=this,u=1;s[0].focus();for(var d=0;d<s.length;++d){var h=s[d];!function(t){e.on(h,"click",function(n){e.e_preventDefault(n),l(),t&&t(f)})}(r[d]),e.on(h,"blur",function(){--u,setTimeout(function(){0>=u&&l()},200)}),e.on(h,"focus",function(){++u})}}),e.defineExtension("openNotification",function(o,r){function i(){s||(s=!0,clearTimeout(l),a.parentNode.removeChild(a))}n(this,i);var l,a=t(this,o,r&&r.bottom),s=!1,c=r&&"undefined"!=typeof r.duration?r.duration:5e3;return e.on(a,"click",function(t){e.e_preventDefault(t),i()}),c&&(l=setTimeout(i,c)),i})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){var t=e.getWrapperElement();e.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:t.style.width,height:t.style.height},t.style.width="",t.style.height="auto",t.className+=" CodeMirror-fullscreen",document.documentElement.style.overflow="hidden",e.refresh()}function n(e){var t=e.getWrapperElement();t.className=t.className.replace(/\s*CodeMirror-fullscreen\b/,""),document.documentElement.style.overflow="";var n=e.state.fullScreenRestore;t.style.width=n.width,t.style.height=n.height,window.scrollTo(n.scrollLeft,n.scrollTop),e.refresh()}e.defineOption("fullScreen",!1,function(o,r,i){i==e.Init&&(i=!1),!i!=!r&&(r?t(o):n(o))})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function n(e){t(e);var n=e.state.placeholder=document.createElement("pre");n.style.cssText="height: 0; overflow: visible",n.className="CodeMirror-placeholder";var o=e.getOption("placeholder");"string"==typeof o&&(o=document.createTextNode(o)),n.appendChild(o),e.display.lineSpace.insertBefore(n,e.display.lineSpace.firstChild)}function o(e){i(e)&&n(e)}function r(e){var o=e.getWrapperElement(),r=i(e);o.className=o.className.replace(" CodeMirror-empty","")+(r?" CodeMirror-empty":""),r?n(e):t(e)}function i(e){return 1===e.lineCount()&&""===e.getLine(0)}e.defineOption("placeholder","",function(n,i,l){var a=l&&l!=e.Init;if(i&&!a)n.on("blur",o),n.on("change",r),r(n);else if(!i&&a){n.off("blur",o),n.off("change",r),t(n);var s=n.getWrapperElement();s.className=s.className.replace(" CodeMirror-empty","")}i&&!n.hasFocus()&&o(n)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t){return"pairs"==t&&"string"==typeof e?e:"object"==typeof e&&null!=e[t]?e[t]:u[t]}function n(e){return function(t){return a(t,e)}}function o(e){var t=e.state.closeBrackets;if(!t)return null;var n=e.getModeAt(e.getCursor());return n.closeBrackets||t}function r(n){var r=o(n);if(!r||n.getOption("disableInput"))return e.Pass;for(var i=t(r,"pairs"),l=n.listSelections(),a=0;a<l.length;a++){if(!l[a].empty())return e.Pass;var s=c(n,l[a].head);if(!s||i.indexOf(s)%2!=0)return e.Pass}for(var a=l.length-1;a>=0;a--){var f=l[a].head;n.replaceRange("",d(f.line,f.ch-1),d(f.line,f.ch+1),"+delete")}}function i(n){var r=o(n),i=r&&t(r,"explode");if(!i||n.getOption("disableInput"))return e.Pass;for(var l=n.listSelections(),a=0;a<l.length;a++){if(!l[a].empty())return e.Pass;var s=c(n,l[a].head);if(!s||i.indexOf(s)%2!=0)return e.Pass}n.operation(function(){n.replaceSelection("\n\n",null),n.execCommand("goCharLeft"),l=n.listSelections();for(var e=0;e<l.length;e++){var t=l[e].head.line;n.indentLine(t,null,!0),n.indentLine(t+1,null,!0)}})}function l(t){var n=e.cmpPos(t.anchor,t.head)>0;return{anchor:new d(t.anchor.line,t.anchor.ch+(n?-1:1)),head:new d(t.head.line,t.head.ch+(n?1:-1))}}function a(n,r){var i=o(n);if(!i||n.getOption("disableInput"))return e.Pass;var a=t(i,"pairs"),c=a.indexOf(r);if(-1==c)return e.Pass;for(var u,h,p=t(i,"triples"),m=a.charAt(c+1)==r,g=n.listSelections(),v=c%2==0,y=0;y<g.length;y++){var b,C=g[y],x=C.head,h=n.getRange(x,d(x.line,x.ch+1));if(v&&!C.empty())b="surround";else if(!m&&v||h!=r)if(m&&x.ch>1&&p.indexOf(r)>=0&&n.getRange(d(x.line,x.ch-2),x)==r+r&&(x.ch<=2||n.getRange(d(x.line,x.ch-3),d(x.line,x.ch-2))!=r))b="addFour";else if(m){if(e.isWordChar(h)||!f(n,x,r))return e.Pass;b="both"}else{if(!v||n.getLine(x.line).length!=x.ch&&!s(h,a)&&!/\s/.test(h))return e.Pass;b="both"}else b=p.indexOf(r)>=0&&n.getRange(x,d(x.line,x.ch+3))==r+r+r?"skipThree":"skip";if(u){if(u!=b)return e.Pass}else u=b}var w=c%2?a.charAt(c-1):r,O=c%2?r:a.charAt(c+1);n.operation(function(){if("skip"==u)n.execCommand("goCharRight");else if("skipThree"==u)for(var e=0;3>e;e++)n.execCommand("goCharRight");else if("surround"==u){for(var t=n.getSelections(),e=0;e<t.length;e++)t[e]=w+t[e]+O;n.replaceSelections(t,"around"),t=n.listSelections().slice();for(var e=0;e<t.length;e++)t[e]=l(t[e]);n.setSelections(t)}else"both"==u?(n.replaceSelection(w+O,null),n.triggerElectric(w+O),n.execCommand("goCharLeft")):"addFour"==u&&(n.replaceSelection(w+w+w+w,"before"),n.execCommand("goCharRight"))})}function s(e,t){var n=t.lastIndexOf(e);return n>-1&&n%2==1}function c(e,t){var n=e.getRange(d(t.line,t.ch-1),d(t.line,t.ch+1));return 2==n.length?n:null}function f(t,n,o){var r=t.getLine(n.line),i=t.getTokenAt(n);if(/\bstring2?\b/.test(i.type))return!1;var l=new e.StringStream(r.slice(0,n.ch)+o+r.slice(n.ch),4);for(l.pos=l.start=i.start;;){var a=t.getMode().token(l,i.state);if(l.pos>=n.ch+1)return/\bstring2?\b/.test(a);l.start=l.pos}}var u={pairs:"()[]{}''\"\"",triples:"",explode:"[]{}"},d=e.Pos;e.defineOption("autoCloseBrackets",!1,function(t,n,o){o&&o!=e.Init&&(t.removeKeyMap(p),t.state.closeBrackets=null),n&&(t.state.closeBrackets=n,t.addKeyMap(p))});for(var h=u.pairs+"`",p={Backspace:r,Enter:i},m=0;m<h.length;m++)p["'"+h.charAt(m)+"'"]=n(h.charAt(m))}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){function t(t){if(t.getOption("disableInput"))return e.Pass;for(var n=t.listSelections(),o=[],s=0;s<n.length;s++){if(!n[s].empty())return e.Pass;var c=n[s].head,f=t.getTokenAt(c),u=e.innerMode(t.getMode(),f.state),d=u.state;if("xml"!=u.mode.name||!d.tagName)return e.Pass;var h=t.getOption("autoCloseTags"),p="html"==u.mode.configuration,m="object"==typeof h&&h.dontCloseTags||p&&l,g="object"==typeof h&&h.indentTags||p&&a,v=d.tagName;f.end>c.ch&&(v=v.slice(0,v.length-f.end+c.ch));var y=v.toLowerCase();if(!v||"string"==f.type&&(f.end!=c.ch||!/[\"\']/.test(f.string.charAt(f.string.length-1))||1==f.string.length)||"tag"==f.type&&"closeTag"==d.type||f.string.indexOf("/")==f.string.length-1||m&&r(m,y)>-1||i(t,v,c,d,!0))return e.Pass;var b=g&&r(g,y)>-1;o[s]={indent:b,text:">"+(b?"\n\n":"")+"</"+v+">",newPos:b?e.Pos(c.line+1,0):e.Pos(c.line,c.ch+1)}}for(var s=n.length-1;s>=0;s--){var C=o[s];t.replaceRange(C.text,n[s].head,n[s].anchor,"+insert");var x=t.listSelections().slice(0);x[s]={head:C.newPos,anchor:C.newPos},t.setSelections(x),C.indent&&(t.indentLine(C.newPos.line,null,!0),t.indentLine(C.newPos.line+1,null,!0))}}function n(t,n){for(var o=t.listSelections(),r=[],l=n?"/":"</",a=0;a<o.length;a++){if(!o[a].empty())return e.Pass;var s=o[a].head,c=t.getTokenAt(s),f=e.innerMode(t.getMode(),c.state),u=f.state;if(n&&("string"==c.type||"<"!=c.string.charAt(0)||c.start!=s.ch-1))return e.Pass;var d;if("xml"!=f.mode.name)if("htmlmixed"==t.getMode().name&&"javascript"==f.mode.name)d=l+"script";else{if("htmlmixed"!=t.getMode().name||"css"!=f.mode.name)return e.Pass;d=l+"style"}else{if(!u.context||!u.context.tagName||i(t,u.context.tagName,s,u))return e.Pass;d=l+u.context.tagName}">"!=t.getLine(s.line).charAt(c.end)&&(d+=">"),r[a]=d}t.replaceSelections(r),o=t.listSelections();for(var a=0;a<o.length;a++)(a==o.length-1||o[a].head.line<o[a+1].head.line)&&t.indentLine(o[a].head.line)}function o(t){return t.getOption("disableInput")?e.Pass:n(t,!0)}function r(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;o>n;++n)if(e[n]==t)return n;return-1}function i(t,n,o,r,i){if(!e.scanForClosingTag)return!1;var l=Math.min(t.lastLine()+1,o.line+500),a=e.scanForClosingTag(t,o,null,l);if(!a||a.tag!=n)return!1;for(var s=r.context,c=i?1:0;s&&s.tagName==n;s=s.prev)++c;o=a.to;for(var f=1;c>f;f++){var u=e.scanForClosingTag(t,o,null,l);if(!u||u.tag!=n)return!1;o=u.to}return!0}e.defineOption("autoCloseTags",!1,function(n,r,i){if(i!=e.Init&&i&&n.removeKeyMap("autoCloseTags"),r){var l={name:"autoCloseTags"};("object"!=typeof r||r.whenClosing)&&(l["'/'"]=function(e){return o(e)}),("object"!=typeof r||r.whenOpening)&&(l["'>'"]=function(e){return t(e)}),n.addKeyMap(l)}});var l=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],a=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];e.commands.closeTag=function(e){return n(e)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){e.defineOption("showTrailingSpace",!1,function(t,n,o){o==e.Init&&(o=!1),o&&!n?t.removeOverlay("trailingspace"):!o&&n&&t.addOverlay({token:function(e){for(var t=e.string.length,n=t;n&&/\s/.test(e.string.charAt(n-1));--n);return n>e.pos?(e.pos=n,null):(e.pos=t,"trailingspace")},name:"trailingspace"})})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","brace",function(t,n){function o(o){for(var r=n.ch,s=0;;){var c=0>=r?-1:a.lastIndexOf(o,r-1);if(-1!=c){if(1==s&&c<n.ch)break;if(i=t.getTokenTypeAt(e.Pos(l,c+1)),!/^(comment|string)/.test(i))return c+1;r=c-1}else{if(1==s)break;s=1,r=a.length}}}var r,i,l=n.line,a=t.getLine(l),s="{",c="}",r=o("{");if(null==r&&(s="[",c="]",r=o("[")),null!=r){var f,u,d=1,h=t.lastLine();e:for(var p=l;h>=p;++p)for(var m=t.getLine(p),g=p==l?r:0;;){var v=m.indexOf(s,g),y=m.indexOf(c,g);if(0>v&&(v=m.length),0>y&&(y=m.length),g=Math.min(v,y),g==m.length)break;if(t.getTokenTypeAt(e.Pos(p,g+1))==i)if(g==v)++d;else if(!--d){f=p,u=g;break e}++g}if(null!=f&&(l!=f||u!=r))return{from:e.Pos(l,r),to:e.Pos(f,u)}}}),e.registerHelper("fold","import",function(t,n){function o(n){if(n<t.firstLine()||n>t.lastLine())return null;var o=t.getTokenAt(e.Pos(n,1));if(/\S/.test(o.string)||(o=t.getTokenAt(e.Pos(n,o.end+1))),"keyword"!=o.type||"import"!=o.string)return null;for(var r=n,i=Math.min(t.lastLine(),n+10);i>=r;++r){var l=t.getLine(r),a=l.indexOf(";");if(-1!=a)return{startCh:o.end,end:e.Pos(r,a)}}}var r,n=n.line,i=o(n);if(!i||o(n-1)||(r=o(n-2))&&r.end.line==n-1)return null;for(var l=i.end;;){var a=o(l.line+1);if(null==a)break;l=a.end}return{from:t.clipPos(e.Pos(n,i.startCh+1)),to:l}}),e.registerHelper("fold","include",function(t,n){function o(n){if(n<t.firstLine()||n>t.lastLine())return null;var o=t.getTokenAt(e.Pos(n,1));return/\S/.test(o.string)||(o=t.getTokenAt(e.Pos(n,o.end+1))),"meta"==o.type&&"#include"==o.string.slice(0,8)?o.start+8:void 0}var n=n.line,r=o(n);if(null==r||null!=o(n-1))return null;for(var i=n;;){var l=o(i+1);if(null==l)break;++i}return{from:e.Pos(n,r+1),to:t.clipPos(e.Pos(i))}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerGlobalHelper("fold","comment",function(e){return e.blockCommentStart&&e.blockCommentEnd},function(t,n){var o=t.getModeAt(n),r=o.blockCommentStart,i=o.blockCommentEnd;if(r&&i){for(var l,a=n.line,s=t.getLine(a),c=n.ch,f=0;;){var u=0>=c?-1:s.lastIndexOf(r,c-1);if(-1!=u){if(1==f&&u<n.ch)return;if(/comment/.test(t.getTokenTypeAt(e.Pos(a,u+1)))&&(s.slice(u-i.length,u)==i||!/comment/.test(t.getTokenTypeAt(e.Pos(a,u))))){l=u+r.length;break}c=u-1}else{if(1==f)return;f=1,c=s.length}}var d,h,p=1,m=t.lastLine();e:for(var g=a;m>=g;++g)for(var v=t.getLine(g),y=g==a?l:0;;){var b=v.indexOf(r,y),C=v.indexOf(i,y);if(0>b&&(b=v.length),0>C&&(C=v.length),y=Math.min(b,C),y==v.length)break;if(y==b)++p;else if(!--p){d=g,h=y;break e}++y}if(null!=d&&(a!=d||h!=l))return{from:e.Pos(a,l),to:e.Pos(d,h)}}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,r,i,l){function a(e){var n=s(t,r);if(!n||n.to.line-n.from.line<c)return null;for(var o=t.findMarksAt(n.from),i=0;i<o.length;++i)if(o[i].__isFold&&"fold"!==l){if(!e)return null;n.cleared=!0,o[i].clear()}return n}if(i&&i.call){var s=i;i=null}else var s=o(t,i,"rangeFinder");"number"==typeof r&&(r=e.Pos(r,0));var c=o(t,i,"minFoldSize"),f=a(!0);if(o(t,i,"scanUp"))for(;!f&&r.line>t.firstLine();)r=e.Pos(r.line-1,0),f=a(!1);if(f&&!f.cleared&&"unfold"!==l){var u=n(t,i);e.on(u,"mousedown",function(t){d.clear(),e.e_preventDefault(t)});var d=t.markText(f.from,f.to,{replacedWith:u,clearOnEnter:!0,__isFold:!0});d.on("clear",function(n,o){e.signal(t,"unfold",t,n,o)}),e.signal(t,"fold",t,f.from,f.to)}}function n(e,t){var n=o(e,t,"widget");if("string"==typeof n){var r=document.createTextNode(n);n=document.createElement("span"),n.appendChild(r),n.className="CodeMirror-foldmarker"}return n}function o(e,t,n){if(t&&void 0!==t[n])return t[n];var o=e.options.foldOptions;return o&&void 0!==o[n]?o[n]:r[n]}e.newFoldFunction=function(e,n){return function(o,r){t(o,r,{rangeFinder:e,widget:n})}},e.defineExtension("foldCode",function(e,n,o){t(this,e,n,o)}),e.defineExtension("isFolded",function(e){for(var t=this.findMarksAt(e),n=0;n<t.length;++n)if(t[n].__isFold)return!0}),e.commands.toggleFold=function(e){e.foldCode(e.getCursor())},e.commands.fold=function(e){e.foldCode(e.getCursor(),null,"fold")},e.commands.unfold=function(e){e.foldCode(e.getCursor(),null,"unfold")},e.commands.foldAll=function(t){t.operation(function(){for(var n=t.firstLine(),o=t.lastLine();o>=n;n++)t.foldCode(e.Pos(n,0),null,"fold")})},e.commands.unfoldAll=function(t){t.operation(function(){for(var n=t.firstLine(),o=t.lastLine();o>=n;n++)t.foldCode(e.Pos(n,0),null,"unfold")})},e.registerHelper("fold","combine",function(){var e=Array.prototype.slice.call(arguments,0);return function(t,n){for(var o=0;o<e.length;++o){var r=e[o](t,n);if(r)return r}}}),e.registerHelper("fold","auto",function(e,t){for(var n=e.getHelpers(t,"fold"),o=0;o<n.length;o++){var r=n[o](e,t);if(r)return r}});var r={rangeFinder:e.fold.auto,widget:"↔",minFoldSize:0,scanUp:!1};e.defineOption("foldOptions",null),e.defineExtension("foldOption",function(e,t){return o(this,e,t)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./foldcode"],e):e(CodeMirror)}(function(e){"use strict";function t(e){this.options=e,this.from=this.to=0}function n(e){return e===!0&&(e={}),null==e.gutter&&(e.gutter="CodeMirror-foldgutter"),null==e.indicatorOpen&&(e.indicatorOpen="CodeMirror-foldgutter-open"),null==e.indicatorFolded&&(e.indicatorFolded="CodeMirror-foldgutter-folded"),e}function o(e,t){for(var n=e.findMarksAt(u(t)),o=0;o<n.length;++o)if(n[o].__isFold&&n[o].find().from.line==t)return n[o]}function r(e){if("string"==typeof e){var t=document.createElement("div");return t.className=e+" CodeMirror-guttermarker-subtle",t}return e.cloneNode(!0)}function i(e,t,n){var i=e.state.foldGutter.options,l=t,a=e.foldOption(i,"minFoldSize"),s=e.foldOption(i,"rangeFinder");e.eachLine(t,n,function(t){var n=null;if(o(e,l))n=r(i.indicatorFolded);else{var c=u(l,0),f=s&&s(e,c);f&&f.to.line-f.from.line>=a&&(n=r(i.indicatorOpen))}e.setGutterMarker(t,i.gutter,n),++l})}function l(e){var t=e.getViewport(),n=e.state.foldGutter;n&&(e.operation(function(){i(e,t.from,t.to)}),n.from=t.from,n.to=t.to)}function a(e,t,n){var r=e.state.foldGutter;if(r){var i=r.options;if(n==i.gutter){var l=o(e,t);l?l.clear():e.foldCode(u(t,0),i.rangeFinder)}}}function s(e){var t=e.state.foldGutter;if(t){var n=t.options;t.from=t.to=0,clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){l(e)},n.foldOnChangeTimeSpan||600)}}function c(e){var t=e.state.foldGutter;if(t){var n=t.options;clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){var n=e.getViewport();t.from==t.to||n.from-t.to>20||t.from-n.to>20?l(e):e.operation(function(){n.from<t.from&&(i(e,n.from,t.from),t.from=n.from),n.to>t.to&&(i(e,t.to,n.to),t.to=n.to)})},n.updateViewportTimeSpan||400)}}function f(e,t){var n=e.state.foldGutter;if(n){var o=t.line;o>=n.from&&o<n.to&&i(e,o,o+1)}}e.defineOption("foldGutter",!1,function(o,r,i){i&&i!=e.Init&&(o.clearGutter(o.state.foldGutter.options.gutter),o.state.foldGutter=null,o.off("gutterClick",a),o.off("change",s),o.off("viewportChange",c),o.off("fold",f),o.off("unfold",f),o.off("swapDoc",s)),r&&(o.state.foldGutter=new t(n(r)),l(o),o.on("gutterClick",a),o.on("change",s),o.on("viewportChange",c),o.on("fold",f),o.on("unfold",f),o.on("swapDoc",s))});var u=e.Pos}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","indent",function(t,n){var o=t.getOption("tabSize"),r=t.getLine(n.line);if(/\S/.test(r)){for(var i=function(t){return e.countColumn(t,null,o)},l=i(r),a=null,s=n.line+1,c=t.lastLine();c>=s;++s){var f=t.getLine(s),u=i(f);if(u>l)a=s;else if(/\S/.test(f))break}return a?{from:e.Pos(n.line,r.length),to:e.Pos(a,t.getLine(a).length)}:void 0}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","markdown",function(t,n){function o(n){var o=t.getTokenTypeAt(e.Pos(n,0));return o&&/\bheader\b/.test(o)}function r(e,t,n){var r=t&&t.match(/^#+/);return r&&o(e)?r[0].length:(r=n&&n.match(/^[=\-]+\s*$/),r&&o(e+1)?"="==n[0]?1:2:i)}var i=100,l=t.getLine(n.line),a=t.getLine(n.line+1),s=r(n.line,l,a);if(s!==i){for(var c=t.lastLine(),f=n.line,u=t.getLine(f+2);c>f&&!(r(f+1,a,u)<=s);)++f,a=u,u=t.getLine(f+2);return{from:e.Pos(n.line,l.length),to:e.Pos(f,t.getLine(f).length)}}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return e.line-t.line||e.ch-t.ch}function n(e,t,n,o){this.line=t,this.ch=n,this.cm=e,this.text=e.getLine(t),this.min=o?o.from:e.firstLine(),this.max=o?o.to-1:e.lastLine()}function o(e,t){var n=e.cm.getTokenTypeAt(d(e.line,t));return n&&/\btag\b/.test(n)}function r(e){return e.line>=e.max?void 0:(e.ch=0,e.text=e.cm.getLine(++e.line),!0)}function i(e){return e.line<=e.min?void 0:(e.text=e.cm.getLine(--e.line),e.ch=e.text.length,!0)}function l(e){for(;;){var t=e.text.indexOf(">",e.ch);if(-1==t){if(r(e))continue;return}{if(o(e,t+1)){var n=e.text.lastIndexOf("/",t),i=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,i?"selfClose":"regular"}e.ch=t+1}}}function a(e){for(;;){var t=e.ch?e.text.lastIndexOf("<",e.ch-1):-1;if(-1==t){if(i(e))continue;return}if(o(e,t+1)){m.lastIndex=t,e.ch=t;var n=m.exec(e.text);if(n&&n.index==t)return n}else e.ch=t}}function s(e){for(;;){m.lastIndex=e.ch;var t=m.exec(e.text);if(!t){if(r(e))continue;return}{if(o(e,t.index+1))return e.ch=t.index+t[0].length,t;e.ch=t.index+1}}}function c(e){for(;;){var t=e.ch?e.text.lastIndexOf(">",e.ch-1):-1;if(-1==t){if(i(e))continue;return}{if(o(e,t+1)){var n=e.text.lastIndexOf("/",t),r=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,r?"selfClose":"regular"}e.ch=t}}}function f(e,t){for(var n=[];;){var o,r=s(e),i=e.line,a=e.ch-(r?r[0].length:0);if(!r||!(o=l(e)))return;if("selfClose"!=o)if(r[1]){for(var c=n.length-1;c>=0;--c)if(n[c]==r[2]){n.length=c;break}if(0>c&&(!t||t==r[2]))return{tag:r[2],from:d(i,a),to:d(e.line,e.ch)}}else n.push(r[2])}}function u(e,t){for(var n=[];;){var o=c(e);if(!o)return;if("selfClose"!=o){var r=e.line,i=e.ch,l=a(e);if(!l)return;if(l[1])n.push(l[2]);else{for(var s=n.length-1;s>=0;--s)if(n[s]==l[2]){n.length=s;break}if(0>s&&(!t||t==l[2]))return{tag:l[2],from:d(e.line,e.ch),to:d(r,i)}}}else a(e)}}var d=e.Pos,h="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",p=h+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",m=new RegExp("<(/?)(["+h+"]["+p+"]*)","g");e.registerHelper("fold","xml",function(e,t){for(var o=new n(e,t.line,0);;){var r,i=s(o);if(!i||o.line!=t.line||!(r=l(o)))return;if(!i[1]&&"selfClose"!=r){var t=d(o.line,o.ch),a=f(o,i[2]);return a&&{from:t,to:a.from}}}}),e.findMatchingTag=function(e,o,r){var i=new n(e,o.line,o.ch,r);if(-1!=i.text.indexOf(">")||-1!=i.text.indexOf("<")){var s=l(i),c=s&&d(i.line,i.ch),h=s&&a(i);if(s&&h&&!(t(i,o)>0)){var p={from:d(i.line,i.ch),to:c,tag:h[2]};return"selfClose"==s?{open:p,close:null,at:"open"}:h[1]?{open:u(i,h[2]),close:p,at:"close"}:(i=new n(e,c.line,c.ch,r),{open:p,close:f(i,h[2]),at:"open"})}}},e.findEnclosingTag=function(e,t,o){for(var r=new n(e,t.line,t.ch,o);;){var i=u(r);if(!i)break;var l=new n(e,t.line,t.ch,o),a=f(l,i.tag);if(a)return{open:i,close:a}}},e.scanForClosingTag=function(e,t,o,r){var i=new n(e,t.line,t.ch,r?{from:0,to:r}:null);return f(i,o)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){function n(e){clearTimeout(o.doRedraw),o.doRedraw=setTimeout(function(){o.redraw()},e)}this.cm=e,this.options=t,this.buttonHeight=t.scrollButtonHeight||e.getOption("scrollButtonHeight"),this.annotations=[],this.doRedraw=this.doUpdate=null,this.div=e.getWrapperElement().appendChild(document.createElement("div")),this.div.style.cssText="position: absolute; right: 0; top: 0; z-index: 7; pointer-events: none",this.computeScale();var o=this;e.on("refresh",this.resizeHandler=function(){clearTimeout(o.doUpdate),o.doUpdate=setTimeout(function(){o.computeScale()&&n(20)},100)}),e.on("markerAdded",this.resizeHandler),e.on("markerCleared",this.resizeHandler),t.listenForChanges!==!1&&e.on("change",this.changeHandler=function(){n(250)})}e.defineExtension("annotateScrollbar",function(e){return"string"==typeof e&&(e={className:e}),new t(this,e)}),e.defineOption("scrollButtonHeight",0),t.prototype.computeScale=function(){var e=this.cm,t=(e.getWrapperElement().clientHeight-e.display.barHeight-2*this.buttonHeight)/e.getScrollerElement().scrollHeight;return t!=this.hScale?(this.hScale=t,!0):void 0},t.prototype.update=function(e){this.annotations=e,this.redraw()},t.prototype.redraw=function(e){function t(e,t){if(s!=e.line&&(s=e.line,c=n.getLineHandle(s)),l&&c.height>a)return n.charCoords(e,"local")[t?"top":"bottom"];var o=n.heightAtLine(c,"local");return o+(t?0:c.height)}e!==!1&&this.computeScale();var n=this.cm,o=this.hScale,r=document.createDocumentFragment(),i=this.annotations,l=n.getOption("lineWrapping"),a=l&&1.5*n.defaultTextHeight(),s=null,c=null;if(n.display.barWidth)for(var f,u=0;u<i.length;u++){for(var d=i[u],h=f||t(d.from,!0)*o,p=t(d.to,!1)*o;u<i.length-1&&(f=t(i[u+1].from,!0)*o,!(f>p+.9));)d=i[++u],p=t(d.to,!1)*o;if(p!=h){var m=Math.max(p-h,3),g=r.appendChild(document.createElement("div"));g.style.cssText="position: absolute; right: 0px; width: "+Math.max(n.display.barWidth-1,2)+"px; top: "+(h+this.buttonHeight)+"px; height: "+m+"px",g.className=this.options.className,d.id&&g.setAttribute("annotation-id",d.id)}}this.div.textContent="",this.div.appendChild(r)},t.prototype.clear=function(){this.cm.off("refresh",this.resizeHandler),this.cm.off("markerAdded",this.resizeHandler),this.cm.off("markerCleared",this.resizeHandler),this.changeHandler&&this.cm.off("change",this.changeHandler),this.div.parentNode.removeChild(this.div)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,n,o){function r(t){var n=e.wheelEventPixels(t)["horizontal"==i.orientation?"x":"y"],o=i.pos;i.moveTo(i.pos+n),i.pos!=o&&e.e_preventDefault(t)}this.orientation=n,this.scroll=o,this.screen=this.total=this.size=1,this.pos=0,this.node=document.createElement("div"),this.node.className=t+"-"+n,this.inner=this.node.appendChild(document.createElement("div"));var i=this;e.on(this.inner,"mousedown",function(t){function n(){e.off(document,"mousemove",o),e.off(document,"mouseup",n)}function o(e){return 1!=e.which?n():void i.moveTo(a+(e[r]-l)*(i.total/i.size))}if(1==t.which){e.e_preventDefault(t);var r="horizontal"==i.orientation?"pageX":"pageY",l=t[r],a=i.pos;e.on(document,"mousemove",o),e.on(document,"mouseup",n)}}),e.on(this.node,"click",function(t){e.e_preventDefault(t);var n,o=i.inner.getBoundingClientRect();n="horizontal"==i.orientation?t.clientX<o.left?-1:t.clientX>o.right?1:0:t.clientY<o.top?-1:t.clientY>o.bottom?1:0,i.moveTo(i.pos+n*i.screen)}),e.on(this.node,"mousewheel",r),e.on(this.node,"DOMMouseScroll",r)}function n(e,n,o){this.addClass=e,this.horiz=new t(e,"horizontal",o),n(this.horiz.node),this.vert=new t(e,"vertical",o),n(this.vert.node),this.width=null}t.prototype.moveTo=function(e,t){0>e&&(e=0),e>this.total-this.screen&&(e=this.total-this.screen),e!=this.pos&&(this.pos=e,this.inner.style["horizontal"==this.orientation?"left":"top"]=e*(this.size/this.total)+"px",t!==!1&&this.scroll(e,this.orientation))};var o=10;t.prototype.update=function(e,t,n){this.screen=t,this.total=e,this.size=n;var r=this.screen*(this.size/this.total);o>r&&(this.size-=o-r,r=o),this.inner.style["horizontal"==this.orientation?"width":"height"]=r+"px",this.inner.style["horizontal"==this.orientation?"left":"top"]=this.pos*(this.size/this.total)+"px"},n.prototype.update=function(e){if(null==this.width){var t=window.getComputedStyle?window.getComputedStyle(this.horiz.node):this.horiz.node.currentStyle;t&&(this.width=parseInt(t.height))}var n=this.width||0,o=e.scrollWidth>e.clientWidth+1,r=e.scrollHeight>e.clientHeight+1;return this.vert.node.style.display=r?"block":"none",this.horiz.node.style.display=o?"block":"none",r&&(this.vert.update(e.scrollHeight,e.clientHeight,e.viewHeight-(o?n:0)),this.vert.node.style.display="block",this.vert.node.style.bottom=o?n+"px":"0"),o&&(this.horiz.update(e.scrollWidth,e.clientWidth,e.viewWidth-(r?n:0)-e.barLeft),this.horiz.node.style.right=r?n+"px":"0",this.horiz.node.style.left=e.barLeft+"px"),{right:r?n:0,bottom:o?n:0}},n.prototype.setScrollTop=function(e){this.vert.moveTo(e,!1)},n.prototype.setScrollLeft=function(e){this.horiz.moveTo(e,!1)},n.prototype.clear=function(){var e=this.horiz.node.parentNode;e.removeChild(this.horiz.node),e.removeChild(this.vert.node)},e.scrollbarModel.simple=function(e,t){return new n("CodeMirror-simplescroll",e,t)},e.scrollbarModel.overlay=function(e,t){return new n("CodeMirror-overlayscroll",e,t)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../dialog/dialog"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t,n,o,r){e.openDialog?e.openDialog(t,r,{value:o,selectValueOnOpen:!0}):r(prompt(n,o))}function n(e,t){var n=Number(t);return/^[-+]/.test(t)?e.getCursor().line+n:n-1}var o='Jump to line: <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use line:column or scroll% syntax)</span>';e.commands.jumpToLine=function(e){var r=e.getCursor();t(e,o,"Jump to line:",r.line+1+":"+r.ch,function(t){if(t){var o;if(o=/^\s*([\+\-]?\d+)\s*\:\s*(\d+)\s*$/.exec(t))e.setCursor(n(e,o[1]),Number(o[2]));else if(o=/^\s*([\+\-]?\d+(\.\d+)?)\%\s*/.exec(t)){var i=Math.round(e.lineCount()*Number(o[1])/100);/^[-+]/.test(o[1])&&(i=r.line+i+1),e.setCursor(i-1,r.ch)}else(o=/^\s*\:?\s*([\+\-]?\d+)\s*/.exec(t))&&e.setCursor(n(e,o[1]),r.ch)}})},e.keyMap["default"]["Alt-G"]="jumpToLine"}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./matchesonscrollbar")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./matchesonscrollbar"],e):e(CodeMirror)}(function(e){"use strict";function t(e){"object"==typeof e&&(this.minChars=e.minChars,this.style=e.style,this.showToken=e.showToken,this.delay=e.delay,this.wordsOnly=e.wordsOnly,this.annotateScrollbar=e.annotateScrollbar),null==this.style&&(this.style=f),null==this.minChars&&(this.minChars=c),null==this.delay&&(this.delay=u),null==this.wordsOnly&&(this.wordsOnly=d),this.overlay=this.timeout=null,this.matchesonscroll=null}function n(e){var t=e.state.matchHighlighter;clearTimeout(t.timeout),t.timeout=setTimeout(function(){i(e)},t.delay)}function o(e,t,n,o){var r=e.state.matchHighlighter;if(e.addOverlay(r.overlay=s(t,n,o)),r.annotateScrollbar){var i=n?new RegExp("\\b"+t+"\\b"):t;r.matchesonscroll=e.showMatchesOnScrollbar(i,!0,{className:"CodeMirror-selection-highlight-scrollbar"})}}function r(e){var t=e.state.matchHighlighter;t.overlay&&(e.removeOverlay(t.overlay),t.overlay=null,t.annotateScrollbar&&(t.matchesonscroll.clear(),t.matchesonscroll=null))}function i(e){e.operation(function(){var t=e.state.matchHighlighter;if(r(e),!e.somethingSelected()&&t.showToken){for(var n=t.showToken===!0?/[\w$]/:t.showToken,i=e.getCursor(),a=e.getLine(i.line),s=i.ch,c=s;s&&n.test(a.charAt(s-1));)--s;for(;c<a.length&&n.test(a.charAt(c));)++c;
return void(c>s&&o(e,a.slice(s,c),n,t.style))}var f=e.getCursor("from"),u=e.getCursor("to");if(f.line==u.line&&(!t.wordsOnly||l(e,f,u))){var d=e.getRange(f,u).replace(/^\s+|\s+$/g,"");d.length>=t.minChars&&o(e,d,!1,t.style)}})}function l(e,t,n){var o=e.getRange(t,n);if(null!==o.match(/^\w+$/)){if(t.ch>0){var r={line:t.line,ch:t.ch-1},i=e.getRange(r,t);if(null===i.match(/\W/))return!1}if(n.ch<e.getLine(t.line).length){var r={line:n.line,ch:n.ch+1},i=e.getRange(n,r);if(null===i.match(/\W/))return!1}return!0}return!1}function a(e,t){return!(e.start&&t.test(e.string.charAt(e.start-1))||e.pos!=e.string.length&&t.test(e.string.charAt(e.pos)))}function s(e,t,n){return{token:function(o){return!o.match(e)||t&&!a(o,t)?(o.next(),void(o.skipTo(e.charAt(0))||o.skipToEnd())):n}}}var c=2,f="matchhighlight",u=100,d=!1;e.defineOption("highlightSelectionMatches",!1,function(o,l,a){a&&a!=e.Init&&(r(o),clearTimeout(o.state.matchHighlighter.timeout),o.state.matchHighlighter=null,o.off("cursorActivity",n)),l&&(o.state.matchHighlighter=new t(l),i(o),o.on("cursorActivity",n))})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./searchcursor"),require("../scroll/annotatescrollbar")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../scroll/annotatescrollbar"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t,n,o){this.cm=e,this.options=o;var r={listenForChanges:!1};for(var i in o)r[i]=o[i];r.className||(r.className="CodeMirror-search-match"),this.annotation=e.annotateScrollbar(r),this.query=t,this.caseFold=n,this.gap={from:e.firstLine(),to:e.lastLine()+1},this.matches=[],this.update=null,this.findMatches(),this.annotation.update(this.matches);var l=this;e.on("change",this.changeHandler=function(e,t){l.onChange(t)})}function n(e,t,n){return t>=e?e:Math.max(t,e+n)}e.defineExtension("showMatchesOnScrollbar",function(e,n,o){return"string"==typeof o&&(o={className:o}),o||(o={}),new t(this,e,n,o)});var o=1e3;t.prototype.findMatches=function(){if(this.gap){for(var t=0;t<this.matches.length;t++){var n=this.matches[t];if(n.from.line>=this.gap.to)break;n.to.line>=this.gap.from&&this.matches.splice(t--,1)}for(var r=this.cm.getSearchCursor(this.query,e.Pos(this.gap.from,0),this.caseFold),i=this.options&&this.options.maxMatches||o;r.findNext();){var n={from:r.from(),to:r.to()};if(n.from.line>=this.gap.to)break;if(this.matches.splice(t++,0,n),this.matches.length>i)break}this.gap=null}},t.prototype.onChange=function(t){var o=t.from.line,r=e.changeEnd(t).line,i=r-t.to.line;if(this.gap?(this.gap.from=Math.min(n(this.gap.from,o,i),t.from.line),this.gap.to=Math.max(n(this.gap.to,o,i),t.from.line)):this.gap={from:t.from.line,to:r+1},i)for(var l=0;l<this.matches.length;l++){var a=this.matches[l],s=n(a.from.line,o,i);s!=a.from.line&&(a.from=e.Pos(s,a.from.ch));var c=n(a.to.line,o,i);c!=a.to.line&&(a.to=e.Pos(c,a.to.ch))}clearTimeout(this.update);var f=this;this.update=setTimeout(function(){f.updateAfterChange()},250)},t.prototype.updateAfterChange=function(){this.findMatches(),this.annotation.update(this.matches)},t.prototype.clear=function(){this.cm.off("change",this.changeHandler),this.annotation.clear()}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./searchcursor"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../dialog/dialog"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return"string"==typeof e?e=new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t?"gi":"g"):e.global||(e=new RegExp(e.source,e.ignoreCase?"gi":"g")),{token:function(t){e.lastIndex=t.pos;var n=e.exec(t.string);return n&&n.index==t.pos?(t.pos+=n[0].length||1,"searching"):void(n?t.pos=n.index:t.skipToEnd())}}}function n(){this.posFrom=this.posTo=this.lastQuery=this.query=null,this.overlay=null}function o(e){return e.state.search||(e.state.search=new n)}function r(e){return"string"==typeof e&&e==e.toLowerCase()}function i(e,t,n){return e.getSearchCursor(t,n,r(t))}function l(e,t,n,o){e.openDialog(t,o,{value:n,selectValueOnOpen:!0,closeOnEnter:!1,onClose:function(){p(e)}})}function a(e,t,n,o,r){e.openDialog?e.openDialog(t,r,{value:o,selectValueOnOpen:!0}):r(prompt(n,o))}function s(e,t,n,o){e.openConfirm?e.openConfirm(t,o):confirm(n)&&o[0]()}function c(e){return e.replace(/\\(.)/g,function(e,t){return"n"==t?"\n":"r"==t?"\r":t})}function f(e){var t=e.match(/^\/(.*)\/([a-z]*)$/);if(t)try{e=new RegExp(t[1],-1==t[2].indexOf("i")?"":"i")}catch(n){}else e=c(e);return("string"==typeof e?""==e:e.test(""))&&(e=/x^/),e}function u(e,n,o){n.queryText=o,n.query=f(o),e.removeOverlay(n.overlay,r(n.query)),n.overlay=t(n.query,r(n.query)),e.addOverlay(n.overlay),e.showMatchesOnScrollbar&&(n.annotate&&(n.annotate.clear(),n.annotate=null),n.annotate=e.showMatchesOnScrollbar(n.query,r(n.query)))}function d(t,n,r){var i=o(t);if(i.query)return h(t,n);var s=t.getSelection()||i.lastQuery;if(r&&t.openDialog){var c=null;l(t,v,s,function(n,o){e.e_stop(o),n&&(n!=i.queryText&&u(t,i,n),c&&(c.style.opacity=1),h(t,o.shiftKey,function(e,n){var o;n.line<3&&document.querySelector&&(o=t.display.wrapper.querySelector(".CodeMirror-dialog"))&&o.getBoundingClientRect().bottom-4>t.cursorCoords(n,"window").top&&((c=o).style.opacity=.4)}))})}else a(t,v,"Search for:",s,function(e){e&&!i.query&&t.operation(function(){u(t,i,e),i.posFrom=i.posTo=t.getCursor(),h(t,n)})})}function h(t,n,r){t.operation(function(){var l=o(t),a=i(t,l.query,n?l.posFrom:l.posTo);(a.find(n)||(a=i(t,l.query,n?e.Pos(t.lastLine()):e.Pos(t.firstLine(),0)),a.find(n)))&&(t.setSelection(a.from(),a.to()),t.scrollIntoView({from:a.from(),to:a.to()},20),l.posFrom=a.from(),l.posTo=a.to(),r&&r(a.from(),a.to()))})}function p(e){e.operation(function(){var t=o(e);t.lastQuery=t.query,t.query&&(t.query=t.queryText=null,e.removeOverlay(t.overlay),t.annotate&&(t.annotate.clear(),t.annotate=null))})}function m(e,t,n){e.operation(function(){for(var o=i(e,t);o.findNext();)if("string"!=typeof t){var r=e.getRange(o.from(),o.to()).match(t);o.replace(n.replace(/\$(\d)/g,function(e,t){return r[t]}))}else o.replace(n)})}function g(e,t){if(!e.getOption("readOnly")){var n=e.getSelection()||o(e).lastQuery,r=t?"Replace all:":"Replace:";a(e,r+y,r,n,function(n){n&&(n=f(n),a(e,b,"Replace with:","",function(o){if(o=c(o),t)m(e,n,o);else{p(e);var r=i(e,n,e.getCursor()),l=function(){var t,c=r.from();!(t=r.findNext())&&(r=i(e,n),!(t=r.findNext())||c&&r.from().line==c.line&&r.from().ch==c.ch)||(e.setSelection(r.from(),r.to()),e.scrollIntoView({from:r.from(),to:r.to()}),s(e,C,"Replace?",[function(){a(t)},l,function(){m(e,n,o)}]))},a=function(e){r.replace("string"==typeof n?o:o.replace(/\$(\d)/g,function(t,n){return e[n]})),l()};l()}}))})}}var v='Search: <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',y=' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',b='With: <input type="text" style="width: 10em" class="CodeMirror-search-field"/>',C="Replace? <button>Yes</button> <button>No</button> <button>All</button> <button>Stop</button>";e.commands.find=function(e){p(e),d(e)},e.commands.findPersistent=function(e){p(e),d(e,!1,!0)},e.commands.findNext=d,e.commands.findPrev=function(e){d(e,!0)},e.commands.clearSearch=p,e.commands.replace=g,e.commands.replaceAll=function(e){g(e,!0)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t,r,i){if(this.atOccurrence=!1,this.doc=e,null==i&&"string"==typeof t&&(i=!1),r=r?e.clipPos(r):o(0,0),this.pos={from:r,to:r},"string"!=typeof t)t.global||(t=new RegExp(t.source,t.ignoreCase?"ig":"g")),this.matches=function(n,r){if(n){t.lastIndex=0;for(var i,l,a=e.getLine(r.line).slice(0,r.ch),s=0;;){t.lastIndex=s;var c=t.exec(a);if(!c)break;if(i=c,l=i.index,s=i.index+(i[0].length||1),s==a.length)break}var f=i&&i[0].length||0;f||(0==l&&0==a.length?i=void 0:l!=e.getLine(r.line).length&&f++)}else{t.lastIndex=r.ch;var a=e.getLine(r.line),i=t.exec(a),f=i&&i[0].length||0,l=i&&i.index;l+f==a.length||f||(f=1)}return i&&f?{from:o(r.line,l),to:o(r.line,l+f),match:i}:void 0};else{var l=t;i&&(t=t.toLowerCase());var a=i?function(e){return e.toLowerCase()}:function(e){return e},s=t.split("\n");if(1==s.length)t.length?this.matches=function(r,i){if(r){var s=e.getLine(i.line).slice(0,i.ch),c=a(s),f=c.lastIndexOf(t);if(f>-1)return f=n(s,c,f),{from:o(i.line,f),to:o(i.line,f+l.length)}}else{var s=e.getLine(i.line).slice(i.ch),c=a(s),f=c.indexOf(t);if(f>-1)return f=n(s,c,f)+i.ch,{from:o(i.line,f),to:o(i.line,f+l.length)}}}:this.matches=function(){};else{var c=l.split("\n");this.matches=function(t,n){var r=s.length-1;if(t){if(n.line-(s.length-1)<e.firstLine())return;if(a(e.getLine(n.line).slice(0,c[r].length))!=s[s.length-1])return;for(var i=o(n.line,c[r].length),l=n.line-1,f=r-1;f>=1;--f,--l)if(s[f]!=a(e.getLine(l)))return;var u=e.getLine(l),d=u.length-c[0].length;if(a(u.slice(d))!=s[0])return;return{from:o(l,d),to:i}}if(!(n.line+(s.length-1)>e.lastLine())){var u=e.getLine(n.line),d=u.length-c[0].length;if(a(u.slice(d))==s[0]){for(var h=o(n.line,d),l=n.line+1,f=1;r>f;++f,++l)if(s[f]!=a(e.getLine(l)))return;if(a(e.getLine(l).slice(0,c[r].length))==s[r])return{from:h,to:o(l,c[r].length)}}}}}}}function n(e,t,n){if(e.length==t.length)return n;for(var o=Math.min(n,e.length);;){var r=e.slice(0,o).toLowerCase().length;if(n>r)++o;else{if(!(r>n))return o;--o}}}var o=e.Pos;t.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){function t(e){var t=o(e,0);return n.pos={from:t,to:t},n.atOccurrence=!1,!1}for(var n=this,r=this.doc.clipPos(e?this.pos.from:this.pos.to);;){if(this.pos=this.matches(e,r))return this.atOccurrence=!0,this.pos.match||!0;if(e){if(!r.line)return t(0);r=o(r.line-1,this.doc.getLine(r.line-1).length)}else{var i=this.doc.lineCount();if(r.line==i-1)return t(i);r=o(r.line+1,0)}}},from:function(){return this.atOccurrence?this.pos.from:void 0},to:function(){return this.atOccurrence?this.pos.to:void 0},replace:function(t,n){if(this.atOccurrence){var r=e.splitLines(t);this.doc.replaceRange(r,this.pos.from,this.pos.to,n),this.pos.to=o(this.pos.from.line+r.length-1,r[r.length-1].length+(1==r.length?this.pos.from.ch:0))}}},e.defineExtension("getSearchCursor",function(e,n,o){return new t(this.doc,e,n,o)}),e.defineDocExtension("getSearchCursor",function(e,n,o){return new t(this,e,n,o)}),e.defineExtension("selectMatches",function(t,n){for(var o=[],r=this.getSearchCursor(t,this.getCursor("from"),n);r.findNext()&&!(e.cmpPos(r.to(),this.getCursor("to"))>0);)o.push({anchor:r.from(),head:r.to()});o.length&&this.setSelections(o,0)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){for(var t=0;t<e.state.activeLines.length;t++)e.removeLineClass(e.state.activeLines[t],"wrap",i),e.removeLineClass(e.state.activeLines[t],"background",l)}function n(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function o(e,o){for(var r=[],a=0;a<o.length;a++){var s=o[a];if(s.empty()){var c=e.getLineHandleVisualStart(s.head.line);r[r.length-1]!=c&&r.push(c)}}n(e.state.activeLines,r)||e.operation(function(){t(e);for(var n=0;n<r.length;n++)e.addLineClass(r[n],"wrap",i),e.addLineClass(r[n],"background",l);e.state.activeLines=r})}function r(e,t){o(e,t.ranges)}var i="CodeMirror-activeline",l="CodeMirror-activeline-background";e.defineOption("styleActiveLine",!1,function(n,i,l){var a=l&&l!=e.Init;i&&!a?(n.state.activeLines=[],o(n,n.listSelections()),n.on("beforeSelectionChange",r)):!i&&a&&(n.off("beforeSelectionChange",r),t(n),delete n.state.activeLines)})});
